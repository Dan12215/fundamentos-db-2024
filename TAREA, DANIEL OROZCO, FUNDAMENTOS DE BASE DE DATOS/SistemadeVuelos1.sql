-- MySQL Script generated by MySQL Workbench
-- Tue Apr  2 23:28:30 2024
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION';

-- -----------------------------------------------------
-- Schema mydb
-- -----------------------------------------------------

-- -----------------------------------------------------
-- Schema mydb
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `mydb` DEFAULT CHARACTER SET utf8 ;
USE `mydb` ;

-- -----------------------------------------------------
-- Table `mydb`.`Aeropuerto`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Aeropuerto` (
  `idAeropuerto` INT NOT NULL,
  `codigo` VARCHAR(10) NULL,
  `nombre` VARCHAR(45) NULL,
  `ciudad` VARCHAR(45) NULL,
  `pais` VARCHAR(45) NULL,
  PRIMARY KEY (`idAeropuerto`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`ModeloAvion`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`ModeloAvion` (
  `idModeloAvion` INT NOT NULL,
  `NombreModelo` VARCHAR(45) NULL,
  `Capacidad` INT NULL,
  `DesarrolloAvion` YEAR(4) NULL,
  PRIMARY KEY (`idModeloAvion`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`ModelosAvionesDis`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`ModelosAvionesDis` (
  `Aeropuerto_idAeropuerto` INT NOT NULL,
  `ModeloAvion_idModeloAvion` INT NOT NULL,
  PRIMARY KEY (`Aeropuerto_idAeropuerto`, `ModeloAvion_idModeloAvion`),
  INDEX `fk_Aeropuerto_has_ModeloAvion_ModeloAvion1_idx` (`ModeloAvion_idModeloAvion` ASC) VISIBLE,
  INDEX `fk_Aeropuerto_has_ModeloAvion_Aeropuerto_idx` (`Aeropuerto_idAeropuerto` ASC) VISIBLE,
  CONSTRAINT `fk_Aeropuerto_has_ModeloAvion_Aeropuerto`
    FOREIGN KEY (`Aeropuerto_idAeropuerto`)
    REFERENCES `mydb`.`Aeropuerto` (`idAeropuerto`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Aeropuerto_has_ModeloAvion_ModeloAvion1`
    FOREIGN KEY (`ModeloAvion_idModeloAvion`)
    REFERENCES `mydb`.`ModeloAvion` (`idModeloAvion`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`Aerolinea`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Aerolinea` (
  `idAerolinea` INT NOT NULL,
  `Nombre` VARCHAR(45) NULL,
  `Contacto` VARCHAR(45) NULL,
  `LugarDeOperaciones` VARCHAR(45) NULL,
  `AnioInicioLabores` YEAR(4) NULL,
  `Estado` VARCHAR(45) NULL,
  `CalificacionServicioAerolinea` VARCHAR(45) NULL,
  PRIMARY KEY (`idAerolinea`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`ProgramaVuelo`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`ProgramaVuelo` (
  `idProgramaVuelo` INT NOT NULL,
  `DiasSemana` VARCHAR(45) NULL,
  `Aerolinea` VARCHAR(45) NULL,
  `NombreTripulacion` VARCHAR(45) NULL,
  `AeropuertoOrigen` VARCHAR(45) NULL,
  `AeropuertoDestino` VARCHAR(45) NULL,
  `ProgramaVuelocol` VARCHAR(45) NULL,
  `Aeropuerto_idAeropuerto` INT NOT NULL,
  `Aerolinea_idAerolinea` INT NOT NULL,
  PRIMARY KEY (`idProgramaVuelo`, `Aeropuerto_idAeropuerto`, `Aerolinea_idAerolinea`),
  INDEX `fk_ProgramaVuelo_Aeropuerto1_idx` (`Aeropuerto_idAeropuerto` ASC) VISIBLE,
  INDEX `fk_ProgramaVuelo_Aerolinea1_idx` (`Aerolinea_idAerolinea` ASC) VISIBLE,
  CONSTRAINT `fk_ProgramaVuelo_Aeropuerto1`
    FOREIGN KEY (`Aeropuerto_idAeropuerto`)
    REFERENCES `mydb`.`Aeropuerto` (`idAeropuerto`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_ProgramaVuelo_Aerolinea1`
    FOREIGN KEY (`Aerolinea_idAerolinea`)
    REFERENCES `mydb`.`Aerolinea` (`idAerolinea`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`EscalaTecnica`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`EscalaTecnica` (
  `idEscalaTecnica` INT NOT NULL,
  `NumeroOrden` INT NULL,
  `AeropuertoEscala` VARCHAR(45) NULL,
  `EscalaTecnicacol` VARCHAR(45) NULL,
  PRIMARY KEY (`idEscalaTecnica`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`ProgramaVuelo_has_EscalaTecnica`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`ProgramaVuelo_has_EscalaTecnica` (
  `ProgramaVuelo_idProgramaVuelo` INT NOT NULL,
  `ProgramaVuelo_Aeropuerto_idAeropuerto` INT NOT NULL,
  `EscalaTecnica_idEscalaTecnica` INT NOT NULL,
  PRIMARY KEY (`ProgramaVuelo_idProgramaVuelo`, `ProgramaVuelo_Aeropuerto_idAeropuerto`, `EscalaTecnica_idEscalaTecnica`),
  INDEX `fk_ProgramaVuelo_has_EscalaTecnica_EscalaTecnica1_idx` (`EscalaTecnica_idEscalaTecnica` ASC) VISIBLE,
  INDEX `fk_ProgramaVuelo_has_EscalaTecnica_ProgramaVuelo1_idx` (`ProgramaVuelo_idProgramaVuelo` ASC, `ProgramaVuelo_Aeropuerto_idAeropuerto` ASC) VISIBLE,
  CONSTRAINT `fk_ProgramaVuelo_has_EscalaTecnica_ProgramaVuelo1`
    FOREIGN KEY (`ProgramaVuelo_idProgramaVuelo` , `ProgramaVuelo_Aeropuerto_idAeropuerto`)
    REFERENCES `mydb`.`ProgramaVuelo` (`idProgramaVuelo` , `Aeropuerto_idAeropuerto`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_ProgramaVuelo_has_EscalaTecnica_EscalaTecnica1`
    FOREIGN KEY (`EscalaTecnica_idEscalaTecnica`)
    REFERENCES `mydb`.`EscalaTecnica` (`idEscalaTecnica`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`Vuelo`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Vuelo` (
  `idVuelo` INT NOT NULL,
  `FechaVuelo` DATE NULL,
  `PlazasVacias` INT NULL,
  `ProgramaVuelo_idProgramaVuelo` INT NOT NULL,
  `ProgramaVuelo_Aeropuerto_idAeropuerto` INT NOT NULL,
  `ModelosAvionesDis_Aeropuerto_idAeropuerto` INT NOT NULL,
  `ModelosAvionesDis_ModeloAvion_idModeloAvion` INT NOT NULL,
  PRIMARY KEY (`idVuelo`, `ProgramaVuelo_idProgramaVuelo`, `ProgramaVuelo_Aeropuerto_idAeropuerto`, `ModelosAvionesDis_Aeropuerto_idAeropuerto`, `ModelosAvionesDis_ModeloAvion_idModeloAvion`),
  INDEX `fk_Vuelo_ProgramaVuelo1_idx` (`ProgramaVuelo_idProgramaVuelo` ASC, `ProgramaVuelo_Aeropuerto_idAeropuerto` ASC) VISIBLE,
  INDEX `fk_Vuelo_ModelosAvionesDis1_idx` (`ModelosAvionesDis_Aeropuerto_idAeropuerto` ASC, `ModelosAvionesDis_ModeloAvion_idModeloAvion` ASC) VISIBLE,
  CONSTRAINT `fk_Vuelo_ProgramaVuelo1`
    FOREIGN KEY (`ProgramaVuelo_idProgramaVuelo` , `ProgramaVuelo_Aeropuerto_idAeropuerto`)
    REFERENCES `mydb`.`ProgramaVuelo` (`idProgramaVuelo` , `Aeropuerto_idAeropuerto`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Vuelo_ModelosAvionesDis1`
    FOREIGN KEY (`ModelosAvionesDis_Aeropuerto_idAeropuerto` , `ModelosAvionesDis_ModeloAvion_idModeloAvion`)
    REFERENCES `mydb`.`ModelosAvionesDis` (`Aeropuerto_idAeropuerto` , `ModeloAvion_idModeloAvion`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`Tripulacion`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Tripulacion` (
  `idTripulacion` INT NOT NULL,
  `Nombre` VARCHAR(45) NULL,
  `Apellidos` VARCHAR(45) NULL,
  `Identificacion` VARCHAR(45) NULL,
  `Funcion` VARCHAR(45) NULL,
  `FechaContratacion` DATE NULL,
  `ProgramaVuelo_idProgramaVuelo` INT NOT NULL,
  `ProgramaVuelo_Aeropuerto_idAeropuerto` INT NOT NULL,
  PRIMARY KEY (`idTripulacion`, `ProgramaVuelo_idProgramaVuelo`, `ProgramaVuelo_Aeropuerto_idAeropuerto`),
  INDEX `fk_Tripulacion_ProgramaVuelo1_idx` (`ProgramaVuelo_idProgramaVuelo` ASC, `ProgramaVuelo_Aeropuerto_idAeropuerto` ASC) VISIBLE,
  CONSTRAINT `fk_Tripulacion_ProgramaVuelo1`
    FOREIGN KEY (`ProgramaVuelo_idProgramaVuelo` , `ProgramaVuelo_Aeropuerto_idAeropuerto`)
    REFERENCES `mydb`.`ProgramaVuelo` (`idProgramaVuelo` , `Aeropuerto_idAeropuerto`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;

-- Insertar datos de ejemplo en la tabla de Aeropuertos
INSERT INTO Aeropuertos (Codigo, Nombre, Ciudad, Pais) VALUES
(2, 'Aeropuerto Internacional de Barcelona-El Prat', 'Barcelona', 'España'),
(4, 'Aeropuerto Internacional Benito Juárez', 'Ciudad de México', 'México'),
(5, 'Aeropuerto Internacional Jorge Chávez', 'Lima', 'Perú'),
(6, 'Aeropuerto Internacional de Los Ángeles', 'Los Ángeles', 'Estados Unidos'),
(7, 'Aeropuerto Internacional de Miami', 'Miami', 'Estados Unidos'),
(8, 'Aeropuerto Internacional de Sydney', 'Sydney', 'Australia'),
(9, 'Aeropuerto Internacional de Tokio-Haneda', 'Tokio', 'Japón'),
(10, 'Aeropuerto Internacional de Dubái', 'Dubái', 'Emiratos Árabes Unidos'),
(11, 'Aeropuerto Internacional de Heathrow', 'Londres', 'Reino Unido'),
(12, 'Aeropuerto Internacional de Changi', 'Singapur', 'Singapur');


-- Insertar datos de ejemplo en la tabla de Aerolinea
INSERT INTO Aerolinea (Nombre, Contacto, LugarDeOperaciones, AnioInicioLabores, Estado, CalificacionServicioAerolinea) VALUES
('American Airlines', 'contacto@aa.com', 'Estados Unidos', 1930, 'funcionando', '4 estrellas'),
('LATAM Airlines', 'contacto@latam.com', 'Chile', 2012, 'funcionando', '4 estrellas'),
('British Airways', 'contacto@ba.com', 'Reino Unido', 1974, 'funcionando', '5 estrellas'),
('Delta Air Lines', 'contacto@delta.com', 'Estados Unidos', 1924, 'funcionando', '4 estrellas'),
('Emirates', 'contacto@emirates.com', 'Emiratos Árabes Unidos', 1985, 'funcionando', '5 estrellas');

-- Insertar datos de ejemplo en la tabla de ModelosAviones
INSERT INTO ModelosAviones (Nombre, Capacidad) VALUES
('Airbus A380', 800),
('Boeing 737', 200),
('Airbus A350', 300),
('Boeing 777', 350),
('Airbus A330', 250),
('Boeing 747', 500),
('Airbus A320', 150),
('Boeing 787', 250),
('Airbus A380', 800),
('Boeing 737', 200);

-- Insertar datos de ejemplo en la tabla de ProgramasVuelo
INSERT INTO ProgramasVuelo (NumeroVuelo, Aerolinea, AeropuertoOrigen, AeropuertoDestino, DiasSemana) VALUES
(6, 'American Airlines', 6, 7, 'Miércoles, Sábado'),
(7, 'LATAM Airlines', 7, 5, 'Lunes, Jueves'),
(8, 'British Airways', 2, 4, 'Martes, Viernes'),
(9, 'Delta Air Lines', 4, 6, 'Miércoles, Sábado'),
(10, 'Emirates', 5, 7, 'Lunes, Jueves'),
(11, 'American Airlines', 7, 5, 'Martes, Domingo'),
(12, 'LATAM Airlines', 8, 4, 'Lunes, Viernes'),
(13, 'British Airways', 9, 6, 'Miércoles, Sábado'),
(14, 'Delta Air Lines', 10, 7, 'Jueves, Domingo'),
(15, 'Emirates', 11, 5, 'Lunes, Sábado');

-- Insertar datos de ejemplo en la tabla de Vuelos
INSERT INTO Vuelos (ID, Fecha, PlazasVacias, ModeloAvion, ProgramaVuelo) VALUES
(2, '2024-04-01', 200, 'Airbus A350', 6),
(3, '2024-04-02', 150, 'Boeing 777', 7),
(4, '2024-04-03', 250, 'Airbus A380', 8),
(5, '2024-04-04', 300, 'Boeing 737', 9),
(6, '2024-04-05', 350, 'Airbus A330', 10),
(7, '2024-04-06', 200, 'Airbus A380', 11),
(8, '2024-04-07', 150, 'Boeing 737', 12),
(9, '2024-04-08', 250, 'Airbus A350', 13),
(10, '2024-04-09', 300, 'Boeing 777', 14),
(11, '2024-04-10', 350, 'Airbus A330', 15);

-- Insertar datos de ejemplo en la tabla de EscalasTecnicas
INSERT INTO EscalasTecnicas (ID, VueloID, AeropuertoEscala, NumeroOrden) VALUES
(2, 2, 6, 1),
(3, 3, 5, 1),
(4, 4, 2, 1),
(5, 5, 4, 1),
(6, 6, 6, 1),
(2, 2, 6, 1),
(3, 3, 5, 1),
(4, 4, 2, 1),
(5, 5, 4, 1),
(6, 6, 6, 1);


-- Insertar datos de ejemplo en la tabla de Tripulacion
INSERT INTO Tripulacion (Nombre, Apellido, Identificacion, Funcion, FechaContratacion) VALUES
('Juan', 'Navarro', '123456789', 'Piloto', '2020-01-15'),
('Mario', 'Gonzales', '987654321', 'Azafata', '2021-05-20'),
('Patricio', 'Paez', '456789123', 'Copiloto', '2019-11-10'),
('Analu', 'Marroquin', '654321987', 'Azafata', '2020-03-25'),
('Edgar', 'Nolasco', '789123456', 'Azafata', '2022-02-18'),
('Rabi', 'Navarro', '123456789', 'Piloto', '2020-01-15'),
('Jimmy', 'Garcia', '987654321', 'Azafata', '2021-05-20'),
('Selvin', 'Juarez', '456789123', 'Copiloto', '2019-11-10'),
('Alan', 'Mardoqueo', '654321987', 'Azafata', '2020-03-25'),
('Jose', 'Orozco', '789123456', 'Azafata', '2022-02-18');


-- Consultas
-- 1. Todas las columnas de la tabla de programa de vuelos.
SELECT *
FROM ProgramaVuelo;

-- 2. Columna nombre de las aerolíneas que su país sea España.
SELECT Nombre
FROM Aerolínea
WHERE País = 'España';

-- 3. Columna código de los aeropuertos que su país sea México.
SELECT Código
FROM Aeropuerto
WHERE País = 'México';

-- 4. Columna modelo de los aviones que su capacidad sea igual o superior a 500.
SELECT Modelo
FROM ModeloAvión
WHERE Capacidad >= 500;

-- 5. Columna modelo de los aviones que su capacidad sea menor a 250.
SELECT Modelo
FROM ModeloAvión
WHERE Capacidad < 250;

-- 6. Todas las columnas de las escalas de los vuelos que tengan paso por Guatemala.
SELECT *
FROM EscalaTécnica
WHERE AeropuertoEscala = 'Guatemala';

-- 7. Actualizar la cantidad de plazas de los aviones de Iberia que actualmente sean menores de 250 a 500 y 500 a 1000.
UPDATE ModeloAvión
SET Capacidad = 
    CASE
        WHEN Capacidad < 250 THEN 500
        WHEN Capacidad = 500 THEN 1000
    END
WHERE Modelo IN (SELECT ModeloAvión FROM ProgramaVuelo WHERE Aerolínea = 'Iberia');

-- 8. Todas aerolinealas columnas de la tabla de tripulación donde el nombre de los pilotos contenga la silaba 'ar'.
SELECT *
FROM Tripulación
WHERE NombreTripulación LIKE '%ar%';
